<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>OpenRouter Costs Visualizer</title>
	<link rel="icon" type="image/png" href="counting-money.png">
	<link href="https://fonts.googleapis.com/css?family=Montserrat|Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
	<link rel="stylesheet" href="./styles.css" />
	<!-- Charts -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
	<script defer src="./app.js"></script>
</head>
<body>
	<header class="topbar">
		<div class="brand">OpenRouter Costs Visualizer</div>

		<div class="controls">
			<div class="control">
				<div id="dropZone" class="drop-zone">
					<div class="drop-zone-content">
						<div class="drop-zone-icon">üìÅ</div>
						<div class="drop-zone-text">
							<div>Drop CSV file here</div>
							<div class="drop-zone-subtext">or click to browse</div>
						</div>
					</div>
					<input id="csvFile" type="file" accept=".csv" hidden />
				</div>
			</div>

			<div class="divider"></div>

			<label class="control">
				<span>From</span>
				<input id="fromDate" type="date" />
			</label>

			<label class="control">
				<span>To</span>
				<input id="toDate" type="date" />
			</label>

			<button id="applyFilters" class="btn primary" type="button">Apply</button>
			<button id="resetFilters" class="btn" type="button">Reset</button>

			<div class="divider"></div>

			<div class="control model-filter">
				<span>Filter models</span>
				<button id="modelFilterBtn" class="btn" type="button">All models</button>
				<div id="modelFilterPanel" class="model-panel" hidden>
					<div class="model-panel-head">
						<input id="modelSearch" type="text" placeholder="Search models..." />
						<div class="spacer"></div>
						<button id="modelSelectAll" class="btn mini" type="button">All</button>
						<button id="modelSelectNone" class="btn mini" type="button">None</button>
					</div>
					<div class="model-list" id="modelList"></div>
				</div>
			</div>
		</div>
	</header>

	<main class="layout">
		<section class="columns">
			<div class="left-col">
				<section class="left-panel">
					<div class="table-header">
						<h2>Costs</h2>
						<div class="control col-filter model-filter">
							<button id="colFilterBtn" class="btn" type="button">Columns Filter</button>
							<div id="colFilterPanel" class="model-panel" hidden>
								<div class="model-panel-head">
									<div class="spacer"></div>
									<button id="colSelectAll" class="btn mini" type="button">All</button>
									<button id="colSelectNone" class="btn mini" type="button">None</button>
								</div>
								<div class="model-list" id="colList"></div>
							</div>
						</div>
					</div>
					<div class="table-wrap">
						<table id="costTable">
							<thead>
								<tr>
									<th data-col="model">Model</th>
									<th data-col="req">Requests</th>
									<th data-col="total">Total Cost</th>
									<th data-col="byok">BYOK</th>
									<th data-col="web">Web Search</th>
									<th data-col="cache">Cache</th>
									<th data-col="file">File Processing</th>
									<th data-col="tp">Tokens Prompt</th>
									<th data-col="avgTp">Avg Tokens Prompt</th>
									<th data-col="tc">Tokens Completion</th>
									<th data-col="tokenOutput">Token Output</th>
									<th data-col="avgTokenOutput">Avg Token Output</th>
									<th data-col="tr">Tokens Reasoning</th>
									<th data-col="avgTr">Avg Tokens Reasoning</th>
									<th data-col="genTime">Avg Gen Time</th>
									<th data-col="ttft">Avg TTFT</th>
								</tr>
							</thead>
							<tbody>
								<!-- Filled dynamically -->
							</tbody>
						</table>
					</div>
				</section>

				<div class="left-bottom">
					<div class="card">
						<h3>Cost by Model</h3>
						<canvas id="barCostByModel"></canvas>
					</div>

					<div class="card">
						<h3>Cost Over Time</h3>
						<canvas id="lineCostOverTime"></canvas>
					</div>
				</div>
			</div>

			<div class="right-col">
				<section class="right-panel">
					<div class="kpis">
						<div class="kpi"><div class="kpi-title">Requests</div><div class="kpi-value" id="kpiRequests">-</div></div>
						<div class="kpi"><div class="kpi-title">Total OpenRouter Cost</div><div class="kpi-value" id="kpiOpenRouterCost">-</div></div>
						<div class="kpi"><div class="kpi-title">Total Cost</div><div class="kpi-value" id="kpiTotalCost">-</div></div>
						<div class="kpi"><div class="kpi-title">Avg Cost / Req</div><div class="kpi-value" id="kpiAvgCost">-</div></div>
						<div class="kpi"><div class="kpi-title">Time Window</div><div class="kpi-value" id="kpiWindow">-</div></div>
					</div>
				</section>

				<!-- Replace notes-card with about-me panel -->
				<div class="card about-me-card">
					<div class="about-me-content">
						<div>
							made with ‚ù§Ô∏è by 
							<a href="https://github.com/lorenzozane" target="_blank" class="about-link mono">@lorenzozane</a>
						</div>
						<div style="margin-top:8px;">
							<a href="https://github.com/lorenzozane" target="_blank" class="about-link"><span class="mono">github</span></a>
							<span> | </span>
							<a href="https://linkedin.com/in/lorenzozane/" target="_blank" class="about-link"><span class="mono">linkedin</span></a>
						</div>
						<div style="margin-top:8px; font-size: x-small;">
							if you want to support, consider
							<a href="https://buymeacoffee.com/lorenzozane" target="_blank" class="about-link"><span class="mono">buymeacoffee</span></a>
						</div>
					</div>
				</div>
			</div>
		</section>
	</main>
</body>
</html>
